<template>
  <div
    class="m-make-your-own-dropdown"
    :class="{ '-small': size === 'small' }"
    @mouseover="toggleDropdownOnDesktop(true)"
    @mouseleave="toggleDropdownOnDesktop(false)"
  >
    <SfButton @click="toggleDropdownOnMobile(true)">
      Make your own
    </SfButton>
    <MDropdown
      :is-open="isDropdownOpen"
      @click:close="toggleDropdownOnMobile(false)"
    >
      <SfList>
        <SfListItem v-for="action in dropdownActions" :key="action.label">
          <router-link
            @click.native="toggleDropdownOnMobile(false)"
            :to="action.url"
          >
            {{ action.label }}
          </router-link>
        </SfListItem>
      </SfList>

      <template #cancel>
        <SfButton
          class="sf-button--full-width sf-dropdown__cancel"
          @click="toggleDropdownOnMobile(false)"
        >
          Cancel
        </SfButton>
      </template>
    </MDropdown>
  </div>
</template>

<script lang="ts">
import Vue from 'vue';
import { SfButton, SfList } from '@storefront-ui/vue';
import {
  mapMobileObserver,
  unMapMobileObserver
} from '@storefront-ui/vue/src/utilities/mobile-observer';

import MDropdown from './m-dropdown.vue';

export default Vue.extend({
  name: 'MMakeYourOwnDropdown',
  props: {
    size: {
      type: String,
      default: ''
    }
  },
  components: {
    MDropdown,
    SfButton,
    SfList
  },
  data () {
    return {
      dropdownActions: [
        {
          label: 'Custom Petsies',
          url: '/forevers-pet-plush/'
        },
        {
          label: 'Golf Headcovers',
          url: '/golf-headcovers/'
        },
        {
          label: 'Custom Pillows',
          url: '/custom-pillows/'
        },
        {
          label: 'Custom Blankets',
          url: '/custom-blankets/'
        },
        {
          label: 'Custom Socks',
          url: {
            name: 'printed-socks-creation-page'
          }
        },
        {
          label: 'Face Masks',
          url: {
            name: 'printed-masks-creation-page'
          }
        },
        {
          label: 'Bobbleheads & Figurines',
          url: '/pet-bobblehead-figurines/'
        },
        {
          label: this.$t('Pajamas'),
          url: {
            name: 'pajamas-creation'
          }
        },
        // {
        //   label: this.$t('Hawaiian Shirts'),
        //   url: {
        //     name: 'hawaiian-shirts-creation'
        //   }
        // },
        {
          label: this.$t('Golf Shirts'),
          url: {
            name: 'golf-shirts-creation'
          }
        },
        {
          label: 'Pet Keychains',
          url: {
            name: 'printed-keychains-creation-page'
          }
        },
        {
          label: 'Pet Magnets',
          url: {
            name: 'felted-magnets-creation-page'
          }
        },
        {
          label: 'Pet Ornaments',
          url: {
            name: 'felted-ornaments-creation-page'
          }
        },
        // {
        //   label: this.$t('Pet Portraits'),
        //   url: {
        //     name: 'photo-portraits-creation-page'
        //   }
        // },
        {
          label: 'Gift Box',
          url: { name: 'giftbox' }
        }
      ],
      isDropdownOpen: false
    };
  },
  computed: {
    ...mapMobileObserver()
  },
  beforeDestroy (): void {
    unMapMobileObserver();
  },
  methods: {
    toggleDropdownOnMobile (shouldOpen: boolean) {
      if (!this.isMobile) {
        return;
      }

      this.isDropdownOpen = shouldOpen;
    },
    toggleDropdownOnDesktop (shouldOpen: boolean) {
      if (this.isMobile) {
        return;
      }

      this.isDropdownOpen = shouldOpen;
    }
  }
});
</script>

<style lang="scss" scoped>
.m-make-your-own-dropdown {
  position: relative;
  align-self: center;

  .sf-button {
    --button-font-size: var(--font-sm);
    --button-font-line-height: 1;
  }

  .sf-dropdown {
    --dropdown-background: var(--c-primary);
    --c-link: var(--c-light-variant);
    --c-link-hover: var(--c-light-variant);
    --list-item-padding: var(--spacer-xs) var(--spacer-sm);

    .sf-list__item {
      &:hover {
        background-color: var(--c-light);
      }

      > a {
        width: 100%;
        display: block;
      }
    }
  }

  &.-small {
    .sf-button {
      --button-font-size: var(--font-2xs);
      --button-font-line-height: 1;
      --button-padding: calc(var(--spacer-2xs) * 3);
    }

    .sf-dropdown {
      left: 0;
    }
  }
}
</style>
