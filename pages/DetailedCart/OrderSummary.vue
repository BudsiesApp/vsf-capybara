<template>
  <div class="detailed-cart-order-summary">
    <SfHeading
      title="Totals"
      :level="2"
      class="sf-heading--left sf-heading--no-underline title"
    />
    <MPriceSummary :is-large="true" />
    <div class="_total-notes">
      {{ $t('All pricing in USD') }}
    </div>
    <div class="actions">
      <APromoCode :allow-promo-code-removal="false">
        <template #bottom-helper-text="{ isCouponApplied }">
          <p class="_helper-text" v-if="!isCouponApplied">
            {{ $t('Please apply gift certificates during checkout (next step)') }}
          </p>
        </template>
      </APromoCode>

      <SfButton
        class="sf-button--full-width actions__button _checkout-button"
        @click="goToCheckout"
      >
        {{ $t('Go to checkout') }}
      </SfButton>
    </div>
    <SfLoader v-if="isUpdatingQuantity" :loading="isUpdatingQuantity" />
  </div>
</template>
<script>
import {
  SfLoader,
  SfHeading,
  SfButton
} from '@storefront-ui/vue';
import { localizedRoute } from '@vue-storefront/core/lib/multistore';
import EventBus from '@vue-storefront/core/compatibility/plugins/event-bus';

import CartEvents from 'src/modules/shared/types/cart-events';

import APromoCode from 'theme/components/atoms/a-promo-code.vue';
import MPriceSummary from 'theme/components/molecules/m-price-summary.vue';
import { mapActions } from 'vuex'

export default {
  name: 'OrderSummary',
  components: {
    MPriceSummary,
    SfLoader,
    APromoCode,
    SfHeading,
    SfButton
  },
  props: {
    isUpdatingQuantity: {
      type: Boolean,
      required: true
    }
  },
  methods: {
    ...mapActions('ui', {
      openModal: 'openModal'
    }),
    goToCheckout () {
      EventBus.$emit(CartEvents.GO_TO_CHECKOUT_FROM_CART)
      this.$router.push(localizedRoute({ name: 'checkout' }));
    }
  }
};
</script>
<style lang="scss" scoped>
@import "~@storefront-ui/vue/styles";

.detailed-cart-order-summary {
  position: relative;
  background: var(--c-light);
  padding: var(--spacer-xl);

  --heading-title-margin: 0 0 var(--spacer-base) 0;

  .title {
    @include for-desktop {
      --heading-title-margin: 0 0 var(--spacer-2xl) 0;
      --heading-title-font-size: var(--h3-font-size);
      --heading-title-font-weight: var(--font-semibold);
    }
  }
  ._total-notes{
    text-align: right;
    font-size: var(--font-sm);

    @include for-desktop {
      font-size: var(--font-base);
    }
  }
  .actions {
    margin-top: var(--spacer-lg);
    &__button {
      margin: var(--spacer-sm) 0;
      &--secondary {
        margin: 0 0 0 var(--spacer-xs);
        text-align: left;
      }
    }
  }
  .promo-code {
    padding: 0;
  }

  ._helper-text {
    margin: var(--spacer-xs) 0 0;
    font-size: var(--font-2xs);
    font-weight: var(--font-medium);
  }

  .sf-loader {
    position: absolute;
    top: 0;
    left: 0;
    opacity: 0.5;
  }
}
</style>
